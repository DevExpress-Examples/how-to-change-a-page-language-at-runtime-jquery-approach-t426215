<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>DevExtreme Sample</title>
    <link rel="stylesheet" type="text/css" href="css/dx.common.css" />
    <link rel="stylesheet" type="text/css" href="css/dx.light.css" />

    <script type="text/javascript" src="js/jquery-2.2.3.min.js"></script>

    <script type="text/javascript" src="js/cldr.min.js"></script>
    <script type="text/javascript" src="js/cldr/event.min.js"></script>
    <script type="text/javascript" src="js/cldr/supplemental.min.js"></script>
    <script type="text/javascript" src="js/globalize.min.js"></script>
    <script type="text/javascript" src="js/globalize/message.min.js"></script>
    <script type="text/javascript" src="js/globalize/number.min.js"></script>
    <script type="text/javascript" src="js/globalize/currency.min.js"></script>
    <script type="text/javascript" src="js/globalize/date.min.js"></script>
    <script type="text/javascript" src="js/dx.all.js"></script>

    <script type="text/javascript" src="appCode.js"></script>
     <script type="text/javascript" src="data.js"></script>
</head>

<body>

    <div id="demo">
        <div id="langContainer"></div>
        <div id="btnContainer"></div>
        <div id="dateContainer"></div>
        <div id="gridContainer"></div>
    </div>

    <script>
        var locCode = ["en", "de", "ru"];
        var locale = "ru";

        var db = new DevExpress.data.LocalStore({
            key: "lang",
            name: "currentLoc",
            immediate: true
        });

        db.load().done(function (data) {
            if (data.length)
                locale = data[0].value;
        });

        $(function () {

            $.when(
                  $.getJSON("cldr/main/" + locale + "/ca-gregorian.json"),
                  $.getJSON("cldr/main/" + locale + "/numbers.json"),
                  $.getJSON("cldr/main/" + locale + "/currencies.json"),
                  $.getJSON("cldr/supplemental/likelySubtags.json"),
                  $.getJSON("cldr/supplemental/timeData.json"),
                  $.getJSON("cldr/supplemental/weekData.json"),
                  $.getJSON("cldr/supplemental/currencyData.json"),
                  $.getJSON("cldr/supplemental/numberingSystems.json")
                ).then(function () {
                    return [].slice.apply(arguments, [0]).map(function (result) {
                        return result[0];
                    });
                }).then(
                    Globalize.load
                ).then(function () {
                    Globalize.loadMessages({
                        en: {
                            "btnText": "Click me",
                            "alertMessage": "I was clicked",
                            "alertTitle": "Warning"
                        },
                        de: {
                            "btnText": "Klick mich",
                            "alertMessage": "Ich habe geklickt",
                            "alertTitle": "Alarm Titel"
                        },
                        ru: {
                            "btnText": "Нажми кнопку",
                            "alertMessage": "Ты нажал кнопку",
                            "alertTitle": "Предупреждение"
                        }
                    })

                    $.getJSON("js/localization/dx.all." + locale + ".json").done(function (dictionary) {
                        Globalize.loadMessages(dictionary);

                        // set locale
                        Globalize.locale(locale);

                        // initialize your app here
                        initAPP();

                    });
                });
        })
    </script>

</body>
</html>
